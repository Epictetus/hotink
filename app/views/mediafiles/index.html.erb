<div id="mediafiles" class="index">
<div class="title_bar"><h1>Media </h1><%= button_link_to 'Upload media', new_account_mediafile_path(@account), :class=>"" %></div>

<div class="clearfix">
<p class="select_all_wrap"><input id="select_all_head" type="checkbox" class="select_all"/> <label for="select_all_head">&nbsp;Select all</label></p>
<% paginated_section(@mediafiles, :inner_window => 1, :outer_window => 1) do %>
<p class="page_entries_info"><%= page_entries_info @mediafiles, :entry_name => "media file" %></p>
</div>
	<ol id="mediafiles_list">
	<% for mediafile in @mediafiles %>
		  <li class="<%= cycle("even-row", "odd-row") %> clearfix">

			<div id="status">
				<input type="checkbox" value="<%= mediafile.id %>"/>
			</div>
			
			
				<% if mediafile.is_a?(Image) %>
			<div class="media">
					<%= image_tag(mediafile.file.url(:system_thumb)) %>
				<% elsif mediafile.is_a?(Audiofile) %>
			<div class="media blank_file">
					<p><%= mediafile.file_file_name.split(".").last.upcase %></p>
				<% else %>
			<div class="media blank_file">
					<p><%= mediafile.file_file_name.split(".").last.upcase %></p>			
				<% end %>
			</div>
			
			<div class="mediafile">
				<h1><%=link_to h(mediafile.title), edit_account_mediafile_url(@account, mediafile), :class=>"document_link" %></h1>
				<div class="mediafile_details clearfix">
					<div class="authors">
						<em><%= mediafile.authors_list if mediafile.authors_list %></em>
					</div>
				</div>
			</div>
			
			<div class="tags">
				<% unless mediafile.tag_list.blank? %>
					<p><em> <%= mediafile.tag_list %></em></p>
				<% else %>
					<p><em> <span style="color: #BBB">No tags</span> </em></p>
				<% end %>
			</div>
			
			<div class="icons">
				<%= link_to "&nbsp;&nbsp;&nbsp;", [@account, mediafile], :confirm => "You are about to delete the mediafile: \n \n &quot;" + h(mediafile.display_title) + "&quot;\n \n Click 'OK' to delete or 'Cancel' to return to the page.", :method => :delete, :class=>"delete_link", :style=>"display:none;" %>
			</div>
			
			<div class="date">
				<%= h mediafile.date.to_s(:standard) %>
			</div>
			
		  </li>
	<% end %>
	</ol>
<% end %>
<p class="select_all_wrap"><input id="select_all_foot" type="checkbox" class="select_all" /><label for="select_all_foot">&nbsp;Select all</label></p>

<br />

<script type="text/javascript" charset="utf-8">
	//Load each article <li> as a Card and check to see if any checkboxes are pre-checked and need to be pre-selected 
	$('mediafiles').select('ol#mediafiles_list>li').each( function (t) { a = new Card(t); if (a.checkbox.checked) a.select(); });
	
	// Activate table header checkboxes select_all functionality
	$$('.select_all').each(	function(element) { 
			Event.observe(element, 'click', function( event ) { 
					if (element.checked){ 
						$$('ol#mediafiles_list>li').each(
								function(el){ 
									el.card.select(); 
								}
						); 
						$$('.select_all').each(
							function(el) {
								el.checked = true;
							}
						);						
					} else {
						$$('ol#mediafiles_list>li').each( 	
							function(el){ 
								el.card.deselect(); 
							}
						); 
						$$('.select_all').each(
							function(el) {
								el.checked = null;
							}
						);
					} 
			})
	});
	
</script>

</div><!-- /articles -->